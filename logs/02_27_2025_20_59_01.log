[ 2025-02-27 20:59:03,767 ] 16 root - INFO - Starting data ingestion
[ 2025-02-27 20:59:03,767 ] 68 root - INFO - Initiating data ingestion
[ 2025-02-27 20:59:03,767 ] 23 root - INFO - Exporting data from MongoDB
[ 2025-02-27 20:59:04,151 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Starting topology monitoring"}
[ 2025-02-27 20:59:04,151 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "previousDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "message": "Topology description changed"}
[ 2025-02-27 20:59:04,194 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "message": "Starting server monitoring"}
[ 2025-02-27 20:59:04,194 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "serverHost": "cluster-us-visa-shard-00-01.aw0kb.mongodb.net", "serverPort": 27017, "message": "Starting server monitoring"}
[ 2025-02-27 20:59:04,194 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "serverHost": "cluster-us-visa-shard-00-00.aw0kb.mongodb.net", "serverPort": 27017, "message": "Starting server monitoring"}
[ 2025-02-27 20:59:04,194 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection pool created", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:04,194 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection pool created", "serverHost": "cluster-us-visa-shard-00-01.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:04,194 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection pool created", "serverHost": "cluster-us-visa-shard-00-00.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:04,202 ] 29 root - INFO - MongoDB connection established successfully
[ 2025-02-27 20:59:04,202 ] 22 root - INFO - Exporting data from collection: us-visa-data in database: Cluster-us-visa
[ 2025-02-27 20:59:04,202 ] 28 root - INFO - Converting collection to DataFrame
[ 2025-02-27 20:59:04,202 ] 100 pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}}
[ 2025-02-27 20:59:04,202 ] 100 pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "remainingTimeMS": 30}
[ 2025-02-27 20:59:04,521 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "driverConnectionId": 1, "serverHost": "cluster-us-visa-shard-00-00.aw0kb.mongodb.net", "serverPort": 27017, "awaited": false, "message": "Server heartbeat started"}
[ 2025-02-27 20:59:04,521 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "driverConnectionId": 1, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "awaited": false, "message": "Server heartbeat started"}
[ 2025-02-27 20:59:04,521 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "driverConnectionId": 1, "serverHost": "cluster-us-visa-shard-00-01.aw0kb.mongodb.net", "serverPort": 27017, "awaited": false, "message": "Server heartbeat started"}
[ 2025-02-27 20:59:04,663 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "driverConnectionId": 1, "serverConnectionId": 15911, "serverHost": "cluster-us-visa-shard-00-00.aw0kb.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 140.99999999598367, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"67c037231863adf23b1a1156\"}, \"counter\": 4}, \"hosts\": [\"cluster-us-visa-shard-00-00.aw0kb.mongodb.net:27017\", \"cluster-us-visa-shard-00-01.aw0kb.mongodb.net:27017\", \"cluster-us-visa-shard-00-02.aw0kb.mongodb.net:27017\"], \"setName\": \"atlas-98kmxc-shard-0\", \"setVersion\": 1, \"secondary\": true, \"primary\": \"cluster-us-visa-shard-00-02.aw0kb.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"cluster-us-visa-shard-00-00.aw0kb.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1740670145, \"i\": 13}}, \"t\": 5}, \"lastWriteDate\": {\"$date\": \"2025-02-27T15:29:05Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1740670145, \"i\": 13}}, \"t\": 5}, \"majorityWriteDate\": {\"$date\": \"2025-02-27T15:29:05Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100...", "message": "Server heartbeat succeeded"}
[ 2025-02-27 20:59:04,671 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "driverConnectionId": 1, "serverConnectionId": 16851, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 140.99999999598367, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"67c038683fa4db7c99cdbdab\"}, \"counter\": 6}, \"hosts\": [\"cluster-us-visa-shard-00-00.aw0kb.mongodb.net:27017\", \"cluster-us-visa-shard-00-01.aw0kb.mongodb.net:27017\", \"cluster-us-visa-shard-00-02.aw0kb.mongodb.net:27017\"], \"setName\": \"atlas-98kmxc-shard-0\", \"setVersion\": 1, \"ismaster\": true, \"primary\": \"cluster-us-visa-shard-00-02.aw0kb.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"availabilityZone\": \"aps1-az2\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\"}, \"me\": \"cluster-us-visa-shard-00-02.aw0kb.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff0000000000000005\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1740670145, \"i\": 13}}, \"t\": 5}, \"lastWriteDate\": {\"$date\": \"2025-02-27T15:29:05Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1740670145, \"i\": 13}}, \"t\": 5}, \"majorityWriteDate\": {\"$date\": \"2025-02-27T15:29:05Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMe...", "message": "Server heartbeat succeeded"}
[ 2025-02-27 20:59:04,672 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "driverConnectionId": 1, "serverConnectionId": 15090, "serverHost": "cluster-us-visa-shard-00-01.aw0kb.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 140.99999999598367, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"67c039809a92a1644d690976\"}, \"counter\": 3}, \"hosts\": [\"cluster-us-visa-shard-00-00.aw0kb.mongodb.net:27017\", \"cluster-us-visa-shard-00-01.aw0kb.mongodb.net:27017\", \"cluster-us-visa-shard-00-02.aw0kb.mongodb.net:27017\"], \"setName\": \"atlas-98kmxc-shard-0\", \"setVersion\": 1, \"secondary\": true, \"primary\": \"cluster-us-visa-shard-00-02.aw0kb.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"availabilityZone\": \"aps1-az3\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"cluster-us-visa-shard-00-01.aw0kb.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1740670145, \"i\": 13}}, \"t\": 5}, \"lastWriteDate\": {\"$date\": \"2025-02-27T15:29:05Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1740670145, \"i\": 13}}, \"t\": 5}, \"majorityWriteDate\": {\"$date\": \"2025-02-27T15:29:05Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100...", "message": "Server heartbeat succeeded"}
[ 2025-02-27 20:59:04,672 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection pool ready", "serverHost": "cluster-us-visa-shard-00-00.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:04,672 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "previousDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "message": "Topology description changed"}
[ 2025-02-27 20:59:04,672 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection pool ready", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:04,672 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "previousDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.14099999999598367>]>", "message": "Topology description changed"}
[ 2025-02-27 20:59:04,672 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "driverConnectionId": 1, "serverConnectionId": 15911, "serverHost": "cluster-us-visa-shard-00-00.aw0kb.mongodb.net", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
[ 2025-02-27 20:59:04,672 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection pool ready", "serverHost": "cluster-us-visa-shard-00-01.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:04,672 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "driverConnectionId": 1, "serverConnectionId": 16851, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
[ 2025-02-27 20:59:04,718 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "previousDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.14099999999598367>]>", "newDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.14099999999598367>]>", "message": "Topology description changed"}
[ 2025-02-27 20:59:04,718 ] 100 pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.14099999999598367>]>", "clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:04,718 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection checkout started", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:04,718 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "driverConnectionId": 1, "serverConnectionId": 15090, "serverHost": "cluster-us-visa-shard-00-01.aw0kb.mongodb.net", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
[ 2025-02-27 20:59:04,718 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection created", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
[ 2025-02-27 20:59:05,483 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection ready", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.3899999999994179}
[ 2025-02-27 20:59:05,483 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection checked out", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.7649999999994179}
[ 2025-02-27 20:59:05,483 ] 100 pymongo.command - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Command started", "command": "{\"find\": \"us-visa-data\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QTuookhvSsOP3ZXHyzsSXg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1740670145, \"i\": 13}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"jFXMDm6CepIBNuBAYrbuLZFPJdY=\", \"subType\": \"00\"}}, \"keyId\": 7475653190168346628}}, \"$db\": \"Cluster-us-visa\"}", "commandName": "find", "databaseName": "Cluster-us-visa", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 16852, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:05,849 ] 100 pymongo.command - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Command succeeded", "durationMS": 365.537, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"67bf1dd20246c17f60d9b1ab\"}, \"case_id\": \"EZYV01\", \"continent\": \"Asia\", \"education_of_employee\": \"High School\", \"has_job_experience\": \"N\", \"requires_job_training\": \"N\", \"no_of_employees\": 14513, \"yr_of_estab\": 2007, \"region_of_employment\": \"West\", \"prevailing_wage\": 592.2029, \"unit_of_wage\": \"Hour\", \"full_time_position\": \"Y\", \"case_status\": \"Denied\"}, {\"_id\": {\"$oid\": \"67bf1dd20246c17f60d9b1b0\"}, \"case_id\": \"EZYV06\", \"continent\": \"Asia\", \"education_of_employee\": \"Master's\", \"has_job_experience\": \"Y\", \"requires_job_training\": \"N\", \"no_of_employees\": 2339, \"yr_of_estab\": 2012, \"region_of_employment\": \"South\", \"prevailing_wage\": 78252.14, \"unit_of_wage\": \"Year\", \"full_time_position\": \"Y\", \"case_status\": \"Certified\"}, {\"_id\": {\"$oid\": \"67bf1dd20246c17f60d9b1b4\"}, \"case_id\": \"EZYV10\", \"continent\": \"Europe\", \"education_of_employee\": \"Doctorate\", \"has_job_experience\": \"Y\", \"requires_job_training\": \"N\", \"no_of_employees\": 2251, \"yr_of_estab\": 1995, \"r...", "commandName": "find", "databaseName": "Cluster-us-visa", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 16852, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:05,849 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection checked in", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
[ 2025-02-27 20:59:05,849 ] 100 pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x000002AE755AC550>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.14099999999598367>]>", "clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}}
[ 2025-02-27 20:59:05,849 ] 100 pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x000002AE755AC550>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 67c084c0b3ceb6979f1ab28b, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('cluster-us-visa-shard-00-00.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-01.aw0kb.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.14099999999598367>, <ServerDescription ('cluster-us-visa-shard-00-02.aw0kb.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.14099999999598367>]>", "clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:05,849 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection checkout started", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:05,849 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection checked out", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0}
[ 2025-02-27 20:59:05,849 ] 100 pymongo.command - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Command started", "command": "{\"getMore\": 6071866334653532230, \"collection\": \"us-visa-data\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"QTuookhvSsOP3ZXHyzsSXg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1740670147, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"/D1GqBeWaHFwQdp4g24mmb1xRmg=\", \"subType\": \"00\"}}, \"keyId\": 7475653190168346628}}, \"$db\": \"Cluster-us-visa\"}", "commandName": "getMore", "databaseName": "Cluster-us-visa", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 16852, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:07,798 ] 100 pymongo.command - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Command succeeded", "durationMS": 1949.7459999999999, "reply": "{\"cursor\": {\"nextBatch\": [{\"_id\": {\"$oid\": \"67bf1dd20246c17f60d9b347\"}, \"case_id\": \"EZYV413\", \"continent\": \"Asia\", \"education_of_employee\": \"Bachelor's\", \"has_job_experience\": \"Y\", \"requires_job_training\": \"Y\", \"no_of_employees\": 2105, \"yr_of_estab\": 2000, \"region_of_employment\": \"West\", \"prevailing_wage\": 26459.67, \"unit_of_wage\": \"Year\", \"full_time_position\": \"Y\", \"case_status\": \"Certified\"}, {\"_id\": {\"$oid\": \"67bf1dd20246c17f60d9b34f\"}, \"case_id\": \"EZYV421\", \"continent\": \"Asia\", \"education_of_employee\": \"Bachelor's\", \"has_job_experience\": \"Y\", \"requires_job_training\": \"N\", \"no_of_employees\": 3094, \"yr_of_estab\": 1986, \"region_of_employment\": \"South\", \"prevailing_wage\": 42657.8, \"unit_of_wage\": \"Year\", \"full_time_position\": \"Y\", \"case_status\": \"Certified\"}, {\"_id\": {\"$oid\": \"67bf1dd20246c17f60d9b351\"}, \"case_id\": \"EZYV423\", \"continent\": \"North America\", \"education_of_employee\": \"Bachelor's\", \"has_job_experience\": \"Y\", \"requires_job_training\": \"N\", \"no_of_employees\": 3817, \"yr_of_esta...", "commandName": "getMore", "databaseName": "Cluster-us-visa", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 16852, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017}
[ 2025-02-27 20:59:07,799 ] 100 pymongo.connection - DEBUG - {"clientId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "message": "Connection checked in", "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
[ 2025-02-27 20:59:07,957 ] 32 root - INFO - Dropped '_id' column if it existed.
[ 2025-02-27 20:59:07,990 ] 35 root - INFO - Replaced 'na' with np.nan.
[ 2025-02-27 20:59:07,990 ] 26 root - INFO - Data exported successfully
[ 2025-02-27 20:59:07,990 ] 27 root - INFO - Dataframe shape: (25480, 12)
[ 2025-02-27 20:59:07,998 ] 32 root - INFO - Saving data to feature store file path: Artifacts\02_27_2025_20_59_03\data_ingestion\feature_store\usvisa.csv
[ 2025-02-27 20:59:08,140 ] 34 root - INFO - Dataframe saved to feature store successfully
[ 2025-02-27 20:59:08,140 ] 44 root - INFO - Splitting data into train and test sets
[ 2025-02-27 20:59:08,257 ] 46 root - INFO - Data split successfully
[ 2025-02-27 20:59:08,257 ] 47 root - INFO - Train dataframe shape: (20384, 12)
[ 2025-02-27 20:59:08,257 ] 48 root - INFO - Test dataframe shape: (5096, 12)
[ 2025-02-27 20:59:08,257 ] 54 root - INFO - Saving train data to file path: Artifacts\02_27_2025_20_59_03\data_ingestion\ingested\train.csv
[ 2025-02-27 20:59:08,407 ] 56 root - INFO - Saving test data to file path: Artifacts\02_27_2025_20_59_03\data_ingestion\ingested\test.csv
[ 2025-02-27 20:59:08,437 ] 58 root - INFO - Data saved to file successfully
[ 2025-02-27 20:59:08,446 ] 73 root - INFO - Data ingestion completed successfully
[ 2025-02-27 20:59:08,454 ] 19 root - INFO - Data ingestion completed successfully
[ 2025-02-27 20:59:08,454 ] 20 root - INFO - ==============================
[ 2025-02-27 20:59:08,792 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "serverHost": "cluster-us-visa-shard-00-01.aw0kb.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 4077.999999994063, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1, "message": "Server heartbeat failed"}
[ 2025-02-27 20:59:08,792 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "serverHost": "cluster-us-visa-shard-00-02.aw0kb.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 4125.0, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1, "message": "Server heartbeat failed"}
[ 2025-02-27 20:59:08,792 ] 100 pymongo.topology - DEBUG - {"topologyId": {"$oid": "67c084c0b3ceb6979f1ab28b"}, "serverHost": "cluster-us-visa-shard-00-00.aw0kb.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 4125.0, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1, "message": "Server heartbeat failed"}
